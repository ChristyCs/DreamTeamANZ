<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Project</title>
        <!--<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>-->
        <script src="d3.js"></script>
        <script type="text/javascript" src="data.js"></script>
    </head>
    <body style = "margin-top: 0px; margin-left: 0px; margin-bottom: 0px">
        <script type="text/javascript">


        var dataFile2008 = []
            var dataFile2009 = []
            var dataFile2010 = []
            var dataFile2011 = []
            var dataFile2012 = []
            var dataFile2013 = []


            load();
        

        var alldata =[];

        function load(){
          console.log('loading')
          // Round,Date,Time,Home Team,Score,Away Team,Venue
            var dataFile2008 = readCSV("ANZChampionshipResults/2008-Table1.csv");
            var dataFile2009 = readCSV("ANZChampionshipResults/2009-Table1.csv");
            var dataFile2010 = readCSV("ANZChampionshipResults/2010-Table1.csv");
            var dataFile2011 = readCSV("ANZChampionshipResults/2011-Table1.csv");
            var dataFile2012 = readCSV("ANZChampionshipResults/2012-Table1.csv");
            var dataFile2013 = readCSV("ANZChampionshipResults/2013-Table1.csv");
            
        }

            function readCSV(fname){
                d3.csv(fname, function(d) {                  
                return readData(d);
            }, function(error, rows) { 
            //console.log(JSON.stringify(rows));                   
                return rows;               
                });
            }

            function readData(d){
               
                return {
                    round: +d.Round,
                    date: d.Date,
                    time: d.Time,
                    hometeam: d['Home Team'],
                    score: d.Score,
                    awayteam: d['Away Team'],
                    venue: d.Venue
                 };
            }

         
           // console.log(dataFile2008);
           // setTimeout(function(){ console.log(dataFile2008); }, 3000);
            
            //console.log('FILE1: ' + readCSV("ANZChampionshipResults/2008-Table1.csv"))
            console.log(alldata)
         
            var width = window.innerWidth;
            var height = window.innerHeight;

            // var width = 1280
            // var height = 650

            var svg = d3.select("body")
                .append("svg")
                .attr("width",width)
                .attr("height",height);

            setupPage();

            //appendText("Queensland Firebirds", width/2, 20, 24)

            function setupPage(){
                svg.append("rect")
                    .attr("x",0)
                    .attr("y",0)
                    .attr("width",width)
                    .attr("height", height*0.1)
                    .attr("fill",("rgb(238,201,0)"));



                svg.append("rect")
                    .attr("x",0)
                    .attr("y",height*0.1)
                    .attr("width",width)
                    .attr("height", height*0.05)
                    .attr("fill",("rgb(151,255,255)"));

                    svg.append("image")
                        .attr("preserveAspectRatio","none")
                        .attr("xlink:href","images/CalendarIcon.png")
                        .attr("x",0)
                        .attr("y",height*0.1)
                        .attr("width",width * 0.04)
                        .attr("height",height * 0.05)

                    svg.append("image")
                        .attr("preserveAspectRatio","none")
                        .attr("xlink:href","images/ANZGamePictures/ANZ2.jpg")
                        .attr("x",0)
                        .attr("y",height*0.15)
                        .attr("width",width)
                        .attr("height",height)
                        .style("opacity", 0.8);
            }

            

            /**
              appends text to the dialog box created in the svg
              given the text and the x and y vals in which the
              text will be placed
            */
            function appendText(text, xVal, yVal, fontsize){
              d3.select("svg")
                .append("text")
                .transition()
                  .attr("id", "button")
                  .text(text)
                  .attr("x", xVal)
                  .attr("y", yVal)
                  .attr("font-size", fontsize)
                  .attr("font-family", "georgia")
                  .attr("fill", "black")
            }


            var g = svg.append("g")

            var rectWidth = width * (1/9)
            var rectHeight = height * (1/6)

            addInfoRects("About", "", width * 0.05, height * 0.7);
            addInfoRects("Venue", "Brisbane Convention and Exhibition Centre", width * 0.35, height * 0.7);
            addInfoRects("Seasons", "", width * 0.65, height * 0.7);

            function addInfoRects(title, text, x, y){
              var clicked = false;

              var seasonsRect = g.append("rect")
                .attr("x",x)
                .attr("y",y)
                .attr("width", rectWidth)
                .attr("height", rectHeight)
                .attr("stroke", "black")
                .attr("fill", "white")
                .on("mouseover", function(){
                  d3.select(this)
                    .transition()
                    .attr("fill", "grey")
                })
                .on("mouseout", function(){
                  d3.select(this)
                    .transition()
                    .attr("fill", "white")
                })
                .on("mousedown", function(){
                  if(!clicked){
                  d3.select(this)
                    .transition()
                    .attr("x", 0)
                    .attr("y", height * 0.15)
                    .attr("width", width - buttWid)
                    .attr("height", height)

                  clicked = true;
                  d3.csv("ANZChampionshipResults/2008-Table1.csv", function(d) {                 
                    return readData(d);
                  }, function(error, rows) { 
                    //console.log(JSON.stringify(rows)); 
                    for (var i = 0; i < rows.length; i++){
                        console.log(rows[i].date)
                    }                  
                    return rows;     



                    // PIE CHART
                    var w = 960,
                    h = 500,
                    radius = Math.min(w, h) / 2;

var color = d3.scale.category20();

var pie = d3.layout.pie()
    .value(function(d) { return d.apples; })
    .sort(null);

var arc = d3.svg.arc()
    .innerRadius(radius - 100)
    .outerRadius(radius - 20);

 svg
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

d3.tsv("data.tsv", type, function(error, data) {
  var path = svg.datum(data).selectAll("path")
      .data(pie)
    .enter().append("path")
      .attr("fill", function(d, i) { return color(i); })
      .attr("d", arc);

  d3.selectAll("input")
      .on("change", change);

  var timeout = setTimeout(function() {
    d3.select("input[value=\"oranges\"]").property("checked", true).each(change);
  }, 2000);

  function change() {
    var value = this.value;
    clearTimeout(timeout);
    pie.value(function(d) { return d[value]; }); // change the value function
    path = path.data(pie); // compute the new angles
    path.attr("d", arc); // redraw the arcs
  }
});

function type(d) {
  d.apples = +d.apples;
  d.oranges = +d.oranges;
  return d;
}



                  });
                    


                  }
                  else{
                    d3.select(this)
                      .transition()
                      .attr("x",x)
                      .attr("y",y)
                      .attr("width", rectWidth)
                      .attr("height", rectHeight)

                    clicked = false;
                  }
                })
                g.append("text")
                  //.attr("id", "button")
                  .text(title)
                  .attr("x", x)
                  .attr("y", y + (rectHeight * 0.5))
                  .attr("font-size", 16)
                  .attr("font-family", "georgia")
                  .attr("fill", "black")
              }

              // NAV BUTTONS

            var buttWid = width * 0.1;
            var buttHgt = height * 0.1;
            var buttY = height *0.2;
            var gap = 50;
            navigationButtons();
            
           

            function navigationButtons(){
            addButton(width - buttWid, height *0.2, buttWid, buttHgt, "rgb(255,255,192)", "Homepage", "Homepage.html");
            addButton(width - buttWid, buttY + (buttHgt*1.5), buttWid, buttHgt, "rgb(238,238,128)", "Teams", "Teams.html");

            addButton(width - buttWid, buttY + (buttHgt*3), buttWid, buttHgt, "rgb(205,205,64)", "Standings", "Standings.html");
            addButton(width - buttWid, buttY + (buttHgt*4.5), buttWid, buttHgt, "rgb(171,171,32)", "Venues", "Venues.html");
            addButton(width - buttWid, buttY + (buttHgt*6), buttWid, buttHgt, "rgb(139,139,0)", "Calendar", "Calendar.html");
             }

            function addButton(x, y, width, height, colour, buttName, link){
                var parent = svg.append("g");
                var rect;
                parent.append("rect")
                    .attr("id", buttName)
                    .attr("x", x)
                    .attr("y", y)
                    .attr("width", width)
                    .attr("height", height)
                    .attr("fill", colour)
                    .on("mouseover", function(){
                        rect = this;
                        d3.select(this)
                            .transition()
                            //.attr("fill", "green")
                            .attr("width", buttWid * 1.3)
                            .attr("x", x - buttWid * 0.3)
                            .attr("y", y - (0.15 * (buttHgt * 1.4)))
                            .attr("height", buttHgt * 1.4);
                     })
                    .on("mouseout", function(d){
                         d3.select(this)
                            .transition()
                            //.style("fill", colour)
                            .attr("width", buttWid)
                            .attr("x", x)
                            .attr("height", height)
                            .attr("y", y);
                    })
                    .on("mousedown", function(){
                        window.open(link, "_self")
                    });

                parent.append("text")
                        .attr("id", "button")
                        .attr("x",  x + 10)
                        .attr("y", y + (0.2*buttWid))
                        .attr("fill", "black")
                        .attr("font-family", "georgia")
                        .attr("font-weight","bold")
                        .style("font-size", "20px")
                        .text(buttName)
                        .on("mouseover", function(){
                        d3.select(rect)
                            .transition()
                            .attr("width", buttWid * 1.3)
                            .attr("x", x - buttWid * 0.3)
                            .attr("y", y - (0.15 * (buttHgt * 1.4)))
                            .attr("height", buttHgt * 1.4);

                        d3.select(this)
                            .transition()
                            .attr("x", x-3 )
                            .attr("fill", "yellow")
                            .style("font-size", "25px");              
                })
                        .on("mouseout", function(d){
                        d3.select(rect)
                            .transition()
                            .attr("width", buttWid)
                            .attr("x", x)
                            .attr("height", height)
                            .attr("y", y);

                        d3.select(this)
                            .transition()
                            .attr("x", x + 10)
                            .attr("y", y + (0.2*buttWid))
                            .attr("fill", "black")
                            .style("font-size", "20px");
                })
            .on("mousedown", function(){
               window.open(link, "_self");
             });
            

            }

        </script>
    </body>
</html>
